"use strict";var gulp=require("gulp"),cssClean=require("gulp-clean-css"),htmlMin=require("gulp-htmlmin"),htmlClean=require("gulp-htmlclean"),uglify=require("gulp-uglify"),babel=require("gulp-babel"),autoprefixer=require("gulp-autoprefixer"),cssnano=require("gulp-cssnano"),imagemin=require("gulp-imagemin"),workbox=require("workbox-build");function htmlMinify(){return gulp.src(["./public/**/*.html","!./public/about/messageboard/index.html"]).pipe(htmlClean()).pipe(htmlMin({removeComments:!0,collapseWhitespace:!0,collapseBooleanAttributes:!0,removeEmptyAttributes:!0,removeScriptTypeAttributes:!0,removeStyleLinkTypeAttributes:!0,minifyJS:!0,minifyCSS:!0,minifyURLs:!0})).pipe(gulp.dest("./public"))}function jsMinify(){return gulp.src(["./public/**/*.js","!./public/**/*.min.js"]).pipe(babel({presets:["@babel/preset-env"]})).pipe(uglify().on("error",function(e){console.log(e)})).pipe(gulp.dest("./public"))}function cssMinify(){return gulp.src("./public/**/*.css").pipe(cssClean({compatibility:"ie11"})).pipe(cssnano({reduceIdents:!1})).pipe(autoprefixer()).pipe(gulp.dest("./public"))}function pwa(){return workbox.injectManifest({swSrc:"./sw-template.js",swDest:"./public/sw.js",globDirectory:"./public",globPatterns:["**/*.{html,css,js,json,woff2}"],modifyURLPrefix:{"":"./"}})}function imageMinify(){return gulp.src(["./public/img/**/*.*","./public/guihai/image/**/*.*"]).pipe(imagemin([imagemin.gifsicle({interlaced:!0}),imagemin.mozjpeg({quality:75,progressive:!0}),imagemin.optipng({optimizationLevel:5}),imagemin.svgo({plugins:[{removeViewBox:!0},{cleanupIDs:!1}]})])).pipe(gulp.dest("./public"))}exports.default=gulp.parallel(pwa,cssMinify,htmlMinify,jsMinify);