"use strict";var markers=[],markerThreshold={min:400,max:1500};function updateMarkers(){for(var e in markers){markers[e].update()}}function attachMarker(e,t){var r,a=document.getElementById("css-camera"),s=document.getElementById("marker_template").cloneNode(!0);s.$=$(s),e.name=e.name.replace("'",""),s.obj=e,s.absPosition=e.position,s.size=void 0!==t?t:1,s.id=e.name,s.style.fontSize="24px",s.spectralIndex=e.spectralIndex,setDivPosition(s,e);var i=s.children[0],o=starSystems[e.name];if(void 0!==o){var n=o.name;i.innerHTML=n}else i.innerHTML=e.name;if("Proxima Centauri"!==e.name&&"Rigel Kentaurus A"!==e.name&&"Rigel Kentaurus B"!==e.name||(s.style.fontSize="10px"),"Rigel Kentaurus B"!==e.name){"Rigel Kentaurus A"===e.name&&(i.innerHTML="Alpha Centauri"),s.defaultSize=s.style.fontSize;var l=s.id.toLowerCase();r=i.innerHTML;var d=l.replace(/ /g,"_"),c=encodeURI("detail/"+d+".html"),u=e.name.match("°");if(u&&"°"==u[0])s.$.addClass("label");else{var m=function(){$.get(c,function(e){var t=$("#detailBody").html(e);t.find("a").each(function(){var e=$(this);ahref=e.attr("href");var t="http://en.wikipedia.org"+ahref;e.attr("href",t),e.attr("target","blank")});var a=$("#detailTitle");a.find("span").html(r);var n=$("#detailFooter");$("#detailContainer").fadeIn(),$("#css-container").css("display","none"),setTimeout(function(){var e=a.outerHeight()+t.outerHeight()+n.outerHeight();$("#detailContainer").css({paddingTop:Math.max(($(window).height()-e)/2,60)+"px"})},0)})};s.$.hover(function(e){s.style.fontSize=10+camera.position.z/200*20+"px"},function(e){s.style.fontSize=s.defaultSize});var h=function(e){var t=s.absPosition.clone();if(0!==t.length()?(console.log("show sun button"),window.showSunButton()):window.hideSunButton(),window.setMinimap(!0),$starName.find("span").html(r),($starName[0].onclick=m)(),void 0!==o){setStarModel(t,s.id);var a=starModel.scale.length(),n=getZoomByStarRadius(a);zoomIn(n);var i=getOffsetByStarRadius(a);t.add(i)}centerOn(t)};s.$.bind("click",h),s.$.bind("touchstart",function(e){1<e.originalEvent.touches.length||h()})}a.appendChild(s),s.setVisible=function(e){return this.style.opacity=e?1:0,this},s.select=function(){var e=s.absPosition.clone();if(0!=enableStarModel){setStarModel(e,s.id);var t=starModel.scale.length(),a=(getZoomByStarRadius(t),i.innerHTML),n=getOffsetByStarRadius(t);$starName.find("span").html(a),$starName[0].onclick=m,e.add(n),snapTo(e)}},s.setSize=function(e){this.style.fontSize=e+"px",this.style.lineHeight=e+"px",this.style.marginTop=-(e+3)/2+"px"};var f=s.querySelector("#startText");s.countryLayer=f,s.update=function(){var e=(.05+camera.position.z/2e3)*this.size;e=constrain(e,0,1),setDivPosition(this,this.obj,e),this.setVisible(camera.markersVisible)},markers.push(s)}}